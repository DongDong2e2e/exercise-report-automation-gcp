# 🤖 AI 개인 트레이너, '버니' 프로젝트

**번핏(BurnFit) 운동 기록 데이터를 활용한 AI 기반 개인 맞춤형 피트니스 대시보드 및 리포팅 시스템**

이 프로젝트는 제가 애용하는 피트니스 앱 '번핏'의 월간 리포트 기능에서 영감을 받아 시작되었습니다. "주간 단위로, 그리고 나의 모든 과거 기록을 누적해서 분석해주는 나만의 트레이너가 있다면 어떨까?" 라는 생각에서 출발한 개인 프로젝트입니다.

### 🤔 왜 만들었나요? (Project Motivation)

*   **📈 단기적 기복 < 장기적 성장:** 컨디션에 따라 기록이 좋아지기도, 나빠지기도 합니다. 어제의 나보다 약해졌다는 생각에 실망하기보다, 꾸준한 기록 속에서 **장기적인 성장 곡선**을 보며 동기부여를 얻고 싶었습니다.
*   **🧠 더 스마트한 피드백:** 훌륭한 월간 리포트를 넘어, **더 짧은 주기의 피드백**과 데이터 기반의 **심층적인 코칭 코멘트**가 필요했습니다.
*   **🏋️‍♂️ 탈-루틴화:** 늘 하던 운동 루틴에 갇히지 않고, 정체기를 극복하고 새로운 자극을 줄 수 있는 **다양한 운동을 추천**받고 싶었습니다.

이러한 필요성을 바탕으로, 번핏의 텍스트 기록을 AI로 분석하여 저만을 위한 대시보드와 자동 리포트를 제공하는 '버니'를 만들게 되었습니다.

### ✨ 주요 기능 (Features)

*   **📊 나만의 맞춤형 운동 대시보드**
    *   제가 가장 중요하게 생각하는 핵심 운동들을 **Push, Pull, Legs 그룹**으로 나누어 성장 추이를 한눈에 볼 수 있습니다.
    *   최근 3개월간의 **인바디 데이터(체중, 골격근량, 체지방률) 변화**를 시각화하여 보여줍니다.

*   **🤖 AI 트레이너 '버니'의 주간 리포트 (이메일 자동 발송)**
    *   매주 Gemini AI가 지난주 운동 데이터를 분석하여 **총 볼륨 변화, 운동 다각화 시도, 성장 포인트** 등을 짚어주는 코칭 코멘트를 생성합니다.
    *   분석 내용을 바탕으로 정체기를 극복하고 다음 단계로 나아가기 위한 **새로운 주간 운동 루틴을 추천**합니다.
    *   이 모든 내용이 아래와 같이 멋진 HTML 형식의 이메일로 매주 자동 발송됩니다.

   <img width="720" height="867" alt="image" src="https://github.com/user-attachments/assets/994543e5-94a2-4217-986b-4201b0591342" />

*   **💬 운동 데이터 분석 챗봇**
    *   "벤치프레스 중량 변화 보여줘"와 같은 자연어 질문을 이해하고, 스프레드시트에서 실시간으로 데이터를 찾아 **채팅창 안에 동적 그래프를 생성**합니다.

*   **✍️ 텍스트 기록의 자동 구조화**
    *   번핏 앱에서 '텍스트로 공유하기' 한 내용을 시트에 붙여넣기만 하면, Apps Script가 이를 자동으로 감지하여 구조화된 데이터로 파싱하고 정리합니다.

### ⚙️ 간단한 사용 방법 (How It Works)

1.  **기록:** 평소처럼 번핏(BurnFit) 앱에 모든 운동을 꼼꼼히 기록합니다.
2.  **복사 & 붙여넣기:** 운동 완료 후, **[공유하기] -> [텍스트 복사]**를 눌러 구글 스프레드시트의 `log` 시트에 그대로 붙여넣습니다.
3.  **자동화:** Apps Script의 `onEdit` 트리거가 변경을 감지하고, 데이터를 자동으로 분석 및 정형화합니다. 이후 시간 기반 트리거가 매주/매월 리포트를 생성하여 지정된 이메일로 발송합니다.

### 🛠️ 기술 스택 (Tech Stack)
*   **Backend:** Google Apps Script (JavaScript)
*   **AI:** Google Gemini 2.5 Pro
*   **Database:** Google Sheets
*   **Frontend:** HTML, CSS, JavaScript, **Chart.js**

### 🏗️ 시스템 아키텍처

이 시스템은 크게 세 가지 핵심 플로우로 작동합니다.

**1. 개인 맞춤형 대시보드 (WebApp 로딩 시)**
1.  **요청:** 사용자가 웹 앱(WebApp)에 접속합니다.
2.  **데이터 추출:** 프론트엔드가 백엔드의 `getDashboardData()` 함수를 호출합니다.
3.  **백엔드 처리:** `getDashboardData()`는 `structured_log` 시트에서 최근 3개월 기록을 필터링하고, **사용자가 지정한 핵심 운동 그룹(Push, Pull, Legs)별** 최고 중량 데이터와 인바디 데이터를 추출 및 가공합니다.
4.  **시각화:** 가공된 데이터를 전달받은 프론트엔드가 `Chart.js` 라이브러리를 사용해 4개의 핵심 성장 그래프를 화면에 렌더링합니다.

**2. 대화형 RAG 챗봇 (사용자 입력 시)**
1.  **질문 분석 (Routing):** 사용자가 질문을 입력하면, `processUserMessage` 함수가 Gemini AI를 호출하여 질문의 의도를 분석하고, 필요한 내부 도구(Tool)를 결정합니다. (예: 일반 텍스트 검색 vs. **그래프 생성**)
2.  **데이터 검색 (Retrieval):**
    *   **(그래프 요청 시):** `findChartData` 함수가 호출되어 특정 운동의 시계열 데이터를 추출하고, 차트 생성을 위한 JSON 객체를 반환합니다.
    *   **(텍스트 질문 시):** `findWorkoutData` 또는 `findInbodyData`가 필요한 정보를 스프레드시트에서 검색합니다.
3.  **답변 생성 (Generation):**
    *   **(그래프의 경우):** 프론트엔드가 차트 JSON 객체를 받아 `Chart.js`로 채팅창 내에 그래프를 직접 그립니다.
    *   **(텍스트의 경우):** 검색된 데이터를 컨텍스트로 삼아 Gemini AI가 최종적으로 자연스러운 문장 형태의 답변을 생성합니다.

**3. 자동 리포팅 시스템 (시간 기반 트리거)**
1.  **트리거 실행:** 매주 월요일 등 지정된 시간에 트리거가 `sendReport` 함수를 실행합니다.
2.  **4단계 추론 아키텍처:**
    *   **1단계 (과거 요약):** 이전 기간의 운동 데이터를 요약하여 컨텍스트를 생성합니다.
    *   **2단계 (현재 분석):** 요약된 과거와 현재 데이터를 비교하여 핵심 인사이트를 도출합니다.
    *   **3단계 (루틴 생성):** 분석된 인사이트를 바탕으로 다음 주를 위한 맞춤형 운동 루틴을 생성합니다.
    *   **4단계 (리포트 종합):** 모든 내용을 종합하여 최종 HTML 이메일 리포트를 생성합니다.
3.  **이메일 발송:** 완성된 리포트를 `MailApp` 서비스를 통해 사용자에게 발송합니다.
---
### 🚀 시작하기 (Setup)

이 프로젝트를 직접 실행해보려면 다음 단계를 따라 설정해야 합니다.

1.  이 저장소의 `Code.gs`와 `index.html` 파일의 내용을 Google Apps Script에 복사하여 새 프로젝트를 생성합니다.
2.  Apps Script 편집기의 왼쪽 메뉴에서 **프로젝트 설정(⚙️)**으로 이동합니다.
3.  **스크립트 속성(Script Properties)** 섹션에 아래 3개의 속성과 값을 추가하고 저장합니다.

| 속성 (Property)              | 설명                                        |
| :--------------------------- | :------------------------------------------ |
| `GEMINI_API_KEY`             | 본인의 Google Gemini API 키                 |
| `REPORT_RECIPIENT_EMAIL`     | 리포트를 수신할 본인의 이메일 주소          |
| `USER_NAME`                  | 리포트와 챗봇에 표시될 이름                 |

4.  `Code.gs` 파일의 `getDashboardData` 함수 내부에 있는 `pushExercises`, `pullExercises`, `legExercises` 배열을 **자신이 추적하고 싶은 주요 운동 목록으로 수정**합니다.
5.  `setup()` 함수를 최초 1회 실행하여 필요한 시트와 트리거를 설정합니다. 이제 모든 준비가 완료되었습니다
