# 🤖 AI 기반 개인 맞춤형 피트니스 대시보드 및 리포팅 시스템

Google Sheets에 텍스트로 작성된 운동일지를 AI가 자동으로 분석하여 정형화하고, 사용자의 실제 주력 운동에 맞춘 **개인화된 데이터 대시보드**를 제공합니다. 또한, 주간/월간 단위의 심층 분석 리포트와 맞춤형 운동 루틴을 이메일로 보내주는 자동화 프로젝트입니다.

### 🎥 주요 기능 시연 (GIF/동영상 추가)
*   **개인 맞춤형 대시보드 (GIF)**
*   **챗봇의 동적 그래프 생성 (GIF)**
*   **이메일 리포트 예시 (스크린샷)**
*   **데이터 자동 파싱 과정 (GIF)**

### ✨ 주요 기능 (Features)
*   **📊 개인 맞춤형 데이터 대시보드 (NEW!)**
    *   웹 앱 접속 시 사용자가 지정한 핵심 운동들을 그룹별(예: Push, Pull, Legs)로 나누어 **성장 추이를 그래프로 시각화**합니다.
    *   최근 3개월간의 인바디 데이터(체중, 골격근량, 체지방률) 변화를 한눈에 파악할 수 있습니다.

*   **📈 동적 그래프 생성 챗봇 (업그레이드됨)**
    *   "벤치프레스 최고 중량 그래프 보여줘"와 같은 자연어 명령을 이해하고, **채팅창 내에 해당 운동의 성장 그래프를 즉시 생성**합니다.
    *   RAG(검색 증강 생성) 아키텍처를 기반으로, 질문에 필요한 데이터를 스프레드시트에서 실시간으로 찾아내 정확한 답변을 제공합니다.

*   **✉️ AI 기반 자동 리포트 및 루틴 추천**
    *   Gemini API의 4단계 추론 아키텍처를 통해 데이터 분석, 심층 인사이트 도출, 그리고 다음 주를 위한 **맞춤형 운동 루틴까지 추천**합니다.
    *   설정된 주기에 따라 주간, 월간, 분기, 연간 리포트를 이메일(HTML)로 자동 발송합니다.

*   **✍️ 텍스트 기록의 자동 정형화**
    *   메모장처럼 자유롭게 작성한 운동 기록을 `onEdit` 트리거와 정규표현식(Regex)을 통해 구조화된 데이터로 자동 파싱하고 정리합니다.

### 🛠️ 기술 스택 (Tech Stack)
*   **Backend:** Google Apps Script (JavaScript)
*   **AI:** Google Gemini 1.5 Pro
*   **Database:** Google Sheets
*   **Frontend:** HTML, CSS, JavaScript, **Chart.js**

### 🏗️ 시스템 아키텍처

이 시스템은 크게 세 가지 핵심 플로우로 작동합니다.

**1. 개인 맞춤형 대시보드 (WebApp 로딩 시)**
1.  **요청:** 사용자가 웹 앱(WebApp)에 접속합니다.
2.  **데이터 추출:** 프론트엔드가 백엔드의 `getDashboardData()` 함수를 호출합니다.
3.  **백엔드 처리:** `getDashboardData()`는 `structured_log` 시트에서 최근 3개월 기록을 필터링하고, **사용자가 지정한 핵심 운동 그룹(Push, Pull, Legs)별** 최고 중량 데이터와 인바디 데이터를 추출 및 가공합니다.
4.  **시각화:** 가공된 데이터를 전달받은 프론트엔드가 `Chart.js` 라이브러리를 사용해 4개의 핵심 성장 그래프를 화면에 렌더링합니다.

**2. 대화형 RAG 챗봇 (사용자 입력 시)**
1.  **질문 분석 (Routing):** 사용자가 질문을 입력하면, `processUserMessage` 함수가 Gemini AI를 호출하여 질문의 의도를 분석하고, 필요한 내부 도구(Tool)를 결정합니다. (예: 일반 텍스트 검색 vs. **그래프 생성**)
2.  **데이터 검색 (Retrieval):**
    *   **(그래프 요청 시):** `findChartData` 함수가 호출되어 특정 운동의 시계열 데이터를 추출하고, 차트 생성을 위한 JSON 객체를 반환합니다.
    *   **(텍스트 질문 시):** `findWorkoutData` 또는 `findInbodyData`가 필요한 정보를 스프레드시트에서 검색합니다.
3.  **답변 생성 (Generation):**
    *   **(그래프의 경우):** 프론트엔드가 차트 JSON 객체를 받아 `Chart.js`로 채팅창 내에 그래프를 직접 그립니다.
    *   **(텍스트의 경우):** 검색된 데이터를 컨텍스트로 삼아 Gemini AI가 최종적으로 자연스러운 문장 형태의 답변을 생성합니다.

**3. 자동 리포팅 시스템 (시간 기반 트리거)**
1.  **트리거 실행:** 매주 월요일 등 지정된 시간에 트리거가 `sendReport` 함수를 실행합니다.
2.  **4단계 추론 아키텍처:**
    *   **1단계 (과거 요약):** 이전 기간의 운동 데이터를 요약하여 컨텍스트를 생성합니다.
    *   **2단계 (현재 분석):** 요약된 과거와 현재 데이터를 비교하여 핵심 인사이트를 도출합니다.
    *   **3단계 (루틴 생성):** 분석된 인사이트를 바탕으로 다음 주를 위한 맞춤형 운동 루틴을 생성합니다.
    *   **4단계 (리포트 종합):** 모든 내용을 종합하여 최종 HTML 이메일 리포트를 생성합니다.
3.  **이메일 발송:** 완성된 리포트를 `MailApp` 서비스를 통해 사용자에게 발송합니다.
---
### 🚀 시작하기 (Setup)

이 프로젝트를 직접 실행해보려면 다음 단계를 따라 설정해야 합니다.

1.  이 저장소의 `Code.gs`와 `index.html` 파일의 내용을 Google Apps Script에 복사하여 새 프로젝트를 생성합니다.
2.  Apps Script 편집기의 왼쪽 메뉴에서 **프로젝트 설정(⚙️)**으로 이동합니다.
3.  **스크립트 속성(Script Properties)** 섹션에 아래 3개의 속성과 값을 추가하고 저장합니다.

| 속성 (Property)              | 설명                                        |
| :--------------------------- | :------------------------------------------ |
| `GEMINI_API_KEY`             | 본인의 Google Gemini API 키                 |
| `REPORT_RECIPIENT_EMAIL`     | 리포트를 수신할 본인의 이메일 주소          |
| `USER_NAME`                  | 리포트와 챗봇에 표시될 이름                 |

4.  `Code.gs` 파일의 `getDashboardData` 함수 내부에 있는 `pushExercises`, `pullExercises`, `legExercises` 배열을 **자신이 추적하고 싶은 주요 운동 목록으로 수정**합니다.
5.  `setup()` 함수를 최초 1회 실행하여 필요한 시트와 트리거를 설정합니다. 이제 모든 준비가 완료되었습니다
